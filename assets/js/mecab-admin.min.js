!function($){"use strict";$(document).ready(function(){$(".example-toggle").click(function(e){e.preventDefault(),$("div.example").toggleClass("toggle")}),$("#mecab-csv-installer").click(function(e){e.preventDefault(),$.get($(this).attr("href")).done(function(e){e.success?$("#user_dic_path").val(e.message):alert(e.message)}).fail(function(e,t,a){alert(a)})});var e={start:null,form:$("#mecab-index-building-form"),doRequest:function(t){$("#indicator-bar").css("width",t.ratio),t.finished?($("#form-message").removeClass("loading"),e.resetForm(),e.form.addClass("finished").find("input[type=submit]").attr("disabled",!1)):(e.form.find("input[name=offset]").val(t.offset),e.form.ajaxSubmit({success:e.doRequest,error:e.errorHandler})),e.addMessage(t.message)},resetForm:function(){this.form.find("input[name=offset]").val("0"),$("#form-message").empty()},addMessage:function(t,a){var s=$(document.createElement(a?"strong":"span")),n=$("#form-message"),r=Math.floor(((new Date).getTime()-e.start.getTime())/1e3);s.text("["+r+"sec] "+t).appendTo(n),n.scrollTop(n.get(0).scrollHeight)},errorHandler:function(){$("#form-message").removeClass("loading"),e.addMessage("Error!",!0),e.form.attr("diabled",!1)}};e.form.length&&e.form.submit(function(t){t.preventDefault(),e.form.find("input[type=submit]").attr("disabled",!0),$("#indicator-bar").css("width",0),$("#form-message").addClass("loading"),e.start=new Date,e.form.ajaxSubmit({success:e.doRequest,error:e.errorHandler})}),$("#mecab-performance").submit(function(t){t.preventDefault(),e.start=new Date,e.resetForm(),$("#form-message").addClass("loading"),$(this).ajaxSubmit({success:function(t){$("#form-message").removeClass("loading"),$.each(t.message.split("\n"),function(t,a){e.addMessage(a)})}})});var t=function(e,t){var a=$("<p></p>");t&&a.addClass("error"),a.text(e),$("#token-result").append(a),setTimeout(function(){a.remove()},3e3)};$(document).on("click","#cost-exec",function(e){e.preventDefault();var a=$("#cost-calc").val(),s=$("#token-result");a.length&&(s.empty(),$.get($(this).attr("href"),{s:a}).done(function(e){e.tokens.length?$.each(e.tokens,function(e,t){s.append($('<a href="#" data-cost="'+t.cost+'"></a>').text(t.surface+" ("+t.cost+")"))}):t(e.message,!0)}).fail(function(e,a,s){t(s,!0)}))}),$("#token-result").on("click","a",function(e){e.preventDefault(),$("#cost").val($(this).attr("data-cost"))});var a=function(e,t){var a=$("#morphem-editor"),s=$("<div><p></p></div>");a.prev("div.error, div.updated").remove(),$.isArray(e)||(e=[e]),s.addClass(t?"error":"updated"),s.find("p").html(e.join("<br />")),a.before(s)};$("#morphem-editor").submit(function(e){e.preventDefault();var t=$(this);t.ajaxSubmit({success:function(e){a(e.message,!e.success),e.reset&&t.get(0).reset()},error:function(e,t,s){a(s,!0)}})}),$(".dictionary-compiler").click(function(e){e.preventDefault();var t=$(this),a,s=function(e,a){var s=$("<span></span>");s.addClass(a?"alert":"warning").text(e),t.next("img").after(s),s.effect("highlight",300,function(){setTimeout(function(){s.fadeOut(500,function(){$(this).remove()})},5e3)})};t.attr("disabled")||(t.attr("disabled",!0).addClass("disabled"),a=t.text(),t.text(t.attr("data-loading")),t.attr("data-loading",a),$.post(t.attr("data-endpoint"),{_wpnonce:t.attr("data-nonce")}).done(function(e){s(e.message,!e.success)}).fail(function(e,t,a){s(a,!0)}).always(function(){t.attr("disabled",!1).removeClass("disabled"),a=t.text(),t.text(t.attr("data-loading")),t.attr("data-loading",a)}))}),$("#check-user-dic").submit(function(e){e.preventDefault();var t=$(this).find("pre");t.empty(),$(this).ajaxSubmit({success:function(e){$.each(e.tokens,function(e,a){var s=$("<span></span>"),n=$("<strong></strong>");s.text(":"+a.feature),n.text(a.surface),s.prepend(n),t.append(s),t.append("<br />")})}})})})}(jQuery);